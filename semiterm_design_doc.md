# SemiTerm 設計ドキュメント（初版）

## 1. アプリ概要

SemiTerm は、Windows / macOS で動作する軽量 SSH ターミナルアプリです。シンプルな機能で高速に動作し、複数タブによる作業効率向上を目的とします。名前は「シンプル（Semi）」かつ「半導体開発分野で利用する用途」に由来します。

## 2. 技術スタック

### フロントエンド（Electron Renderer）

* React + TypeScript
* xterm.js（ターミナル表示）
* Tailwind CSS（スタイル）

### バックエンド（Electron Main）

* Node.js（ssh2 ライブラリを利用）
* IPC（Main ⇄ Renderer）

### プラットフォーム

* Windows / macOS
* 自動アップデートなし

## 3. アプリ構成（プロセス分割）

### Main プロセス

* SSH セッション管理
* 設定ファイル読み書き
* ログ管理
* IPC エンドポイント

### Renderer プロセス

* UI 描画
* タブ管理
* ユーザー操作受付
* SSH 出力のリアルタイム表示

## 4. SSH コンポーネント仕様

* 利用ライブラリ：ssh2
* 自動再接続：**なし**
* タブを閉じた際：対応する SSH session を即時破棄
* Keepalive：ON（10〜30 秒）
* 接続タイムアウト：10 秒
* ログレベル：debug
* 接続エラー：タブ内に表示（タブは残し、× で閉じられる）

## 5. 接続情報フォーマット（JSON）

```json
[
  {
    "id": "uuid",
    "title": "host-label",
    "host": "example.com",
    "port": 22,
    "username": "user",
    "auth": {
      "type": "password", // or "key"
      "password": "***",
      "keyPath": "~/.ssh/id_rsa"
    },
    "createdAt": "ISO8601",
    "updatedAt": "ISO8601"
  }
]
```

## 6. タブ管理仕様

* 最大タブ数制限なし
* タブ名フォーマット：`{連番} - {ホスト名}`

  * 例：`1 - server01`、`2 - 192.168.1.10`

## 7. 保存データ管理

* 保存形式：暗号化なし（暫定）
* 保存先：ローカルファイル（ユーザーのアプリデータ領域）
* 設定ファイルの保存場所：OS 標準のユーザーデータフォルダ

  * Windows: `%APPDATA%/SemiTerm/`
  * macOS: `~/Library/Application Support/SemiTerm/`
* 秘密鍵の扱い：アプリは内容を保存しない、パスのみ保存。読み出しは OS のファイルシステムから行う。

## 8. ログ管理

* 出力レベル：debug
* 保存場所：アプリデータフォルダ内 `logs/` 以下
* ローテーション：**日別フォルダ**（例：`2025-12-05/`）
* ログファイル名：`semiterm.log`

## 9. xterm.js 設定

* フォント：等幅（例：Fira Code / JetBrains Mono）
* カラーテーマ：ライト／ダークは OS 標準設定に追従
* 行バッファ数：10,000 行程度
* マウス・コピー操作：標準設定を有効化

## 10. ウィンドウ管理

* メインウィンドウのみ（マルチウィンドウ対応はしない）
* サイズは前回起動時の状態を保持
* 起動モード：シングルインスタンス

## 11. UI 構成案（バージョン A 採用）

以下に **画面デザインの詳細** を追記する。

### 11.1 画面レイアウト全体

* **左サイドバー（接続リスト）**

  * 幅：240px 固定
  * 背景色：ライト時 #F5F7FA、ダーク時 #1E1E1E
  * 要素構成：

    * 「新規接続」ボタン（＋アイコン）
    * 保存された接続リスト（スクロール可能）
    * 接続アイテムはカード型、ホバー時に枠線強調

* **上部タブバー**

  * 高さ：40px
  * 背景色：OS テーマに合わせる（ライト/ダーク）
  * タブ：

    * フォーマット：`{番号} - {ホスト名}`
    * アクティブタブは強調（背景 #D0E8FF / #333）
    * 非アクティブは軽いシャドウのみ
    * タブ右端に × ボタン

* **中央ターミナル領域**

  * xterm.js 埋め込み
  * 背景色：ライト #FFFFFF / ダーク #0C0C0C
  * 内側の余白：8px
  * タブ切替でフェードインアニメーション

* **下部ステータスバー**

  * 高さ：24px
  * 背景色：タブバーと同一
  * 表示項目：

    * 接続状態（● 緑=接続 / 赤=切断）
    * ログレベル表示（debug）
    * サーバーのホスト名

### 11.2 接続情報編集画面（モーダル）

* 形式：中央配置のモーダル（幅 480px）
* 入力項目：

  * 接続名
  * Host
  * Port
  * Username
  * 認証方式（Password / Key）
  * Password（保存しない旨の注意文付き）
  * Key Path（ファイル選択ボタン付き）
* ボタン：OK / Cancel
* 検証：未入力時は OK を無効化

### 11.3 新規接続タブの動作

* 新規タブを開いた直後に「接続先選択モーダル」を表示
* 接続開始後、ターミナルが表示される
* エラー発生時：

  * タブ内にエラーメッセージを表示するパネル
  * アイコン：⚠
  * 再接続ボタン表示（ショートカット Ctrl+R）

### 11.4 接続リスト UI 詳細

* カード構造：

  * 左：サーバーアイコン
  * 中央：ホスト名 + ユーザー名
  * 右：編集（✎）・削除（🗑）アイコン
* カードクリックで即接続
* 長さが長いホスト名は省略記号

### 11.5 xterm.js のスタイル仕様

* フォント：JetBrains Mono / Fira Code（ユーザー変更不可）
* 文字サイズ：14px
* 行間：1.2
* カーソル：ブロック形状
* カラー：xterm.js の標準テーマ（ライト/ダーク）は OS に追従

### 11.6 ロゴ配置

* アプリ起動時のウィンドウ左上に「SemiTerm」ロゴを 20px 表示
* サイドバー上部にも縮小表示（32px）
* 実装では `resources/icon.png` を利用し、上記 20px / 32px それぞれにスケールして配置する

### 11.7 エラーダイアログのデザイン

* モーダル中央配置、背景 80% 透過オーバーレイ
* 赤系アイコン（⚠）＋ メッセージ
* 「OK」のみ
* 例外：接続エラーはタブ内表示

---

### メイン画面

* 左：接続先一覧（サイドバー）
* 上：タブバー
* 中央：ターミナル領域（各タブが表示）
* 下部：ステータスバー（接続状態、ログレベル表示など）

## 12. アプリ名・ロゴ

* **アプリ名：SemiTerm**
* **ロゴ：明るく、フラット、シンプル。イメージカラー：ブルー**
* 採用済みアイコン：`icon.png`

---

## 12.1 キーボードショートカット仕様

* 新規接続タブを開く: Ctrl+T
* タブを閉じる: Ctrl+W
* タブ切り替え: Ctrl+Tab
* 再接続: Ctrl+R

## 12.2 パスワード保存方針

* パスワードは保存しない（毎回入力する）

## 12.3 プロファイルのインポート/エクスポート

* JSON 形式でインポート/エクスポートに対応する

## 13. 未決定で確認すべき項目

以下は **決めておくと開発がスムーズになる項目** です。

1. **キーボードショートカットの仕様**
2. **接続プロファイルのインポート / エクスポート** の有無
3. **パスワード保存の扱い**（現状平文保存だが、暫定仕様か）
4. **テーマ（ライト／ダーク）の切替 UI** の要否
5. **ログビューア** をアプリ内部に持つかどうか
6. **初回起動時のチュートリアル画面（必要か？）**
7. **エラーダイアログの標準化**（フォーマット・優先度など）

---

必要であれば、上記未決定部分の推奨仕様案も提示できます。
